<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quay s·ªë tr√∫ng th∆∞·ªüng</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f0f4f8;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
    }

    .container {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    input[type="tel"] {
      padding: 0.8rem;
      width: 100%;
      max-width: 300px;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    button {
      margin-top: 1rem;
      padding: 0.8rem 1.5rem;
      font-size: 1rem;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .hidden {
      display: none;
    }

    #wheelCanvas {
      margin-top: 2rem;
      border-radius: 50%;
    }

    .result {
      margin-top: 1.5rem;
      font-size: 1.2rem;
      font-weight: bold;
    }
  </style>
</head>

<body>
  <div class="container">
    <h2>üéÅ Quay s·ªë tr√∫ng th∆∞·ªüng üéÅ</h2>
    <p>Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i c·ªßa b·∫°n ƒë·ªÉ tham gia</p>
    <input type="tel" id="phone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" required>
    <br>
    <button onclick="startGame()">Tham gia</button>

    <canvas id="wheelCanvas" width="300" height="300" class="hidden"></canvas>
    <div class="result hidden" id="result"></div>
  </div>

  <script>
    const prizes = ["Gi·∫£m 5k", "Kh√¥ng tr√∫ng", "T·∫∑ng qu√†", "Gi·∫£m 10k", "Kh√¥ng tr√∫ng", "T·∫∑ng nam ch√¢m"];
    let canvas = document.getElementById("wheelCanvas");
    let ctx = canvas.getContext("2d");
    const colors = ["#ffcc00", "#ff6666", "#66ccff", "#99ff99", "#ff9966", "#cc99ff"];

    function drawWheel(rotation = 0) {
      let arcSize = 2 * Math.PI / prizes.length;
      for (let i = 0; i < prizes.length; i++) {
        ctx.beginPath();
        ctx.moveTo(150, 150);
        ctx.fillStyle = colors[i % colors.length];
        ctx.arc(150, 150, 150, arcSize * i + rotation, arcSize * (i + 1) + rotation);
        ctx.fill();
        ctx.save();
        ctx.translate(150, 150);
        ctx.rotate(arcSize * i + arcSize / 2 + rotation);
        ctx.fillStyle = "#000";
        ctx.font = "14px sans-serif";
        ctx.fillText(prizes[i], 60, 5);
        ctx.restore();
      }
    }

    function spinWheel(phone) {
      let rotation = 0;
      let spins = Math.floor(Math.random() * 10 + 10);
      let angle = 0;
      let spinCount = 0;
      let interval = setInterval(() => {
        angle += 0.2;
        rotation += angle;
        ctx.clearRect(0, 0, 300, 300);
        drawWheel(rotation);
        if (++spinCount > spins) {
          clearInterval(interval);
          let arcSize = 2 * Math.PI / prizes.length;
          let index = prizes.length - Math.floor(((rotation % (2 * Math.PI)) / arcSize)) - 1;
          const prize = prizes[index < 0 ? 0 : index % prizes.length];
          document.getElementById("result").innerText = `üéâ K·∫øt qu·∫£: ${prize} üéâ`;
          document.getElementById("result").classList.remove("hidden");

          // G·ª≠i d·ªØ li·ªáu v·ªÅ Google Sheets
          fetch("https://script.google.com/macros/s/AKfycbztz_fQ4nzDPp7eYc2g6OYRAyGwMHjhZN-ZvMgiEO9XH90d00Bm8UI6EBjszI1_tWz67Q/exec", {
            method: "POST",
            headers: {
              "Content-Type": "application/x-www-form-urlencoded",
            },
            body: `phone=${encodeURIComponent(phone)}&prize=${encodeURIComponent(prize)}`
          });
        }
      }, 100);
    }

    function startGame() {
      const phone = document.getElementById("phone").value;
      if (!phone || phone.length < 9) {
        alert("Vui l√≤ng nh·∫≠p s·ªë ƒëi·ªán tho·∫°i h·ª£p l·ªá");
        return;
      }

      document.getElementById("wheelCanvas").classList.remove("hidden");
      document.getElementById("result").classList.add("hidden");
      ctx.clearRect(0, 0, 300, 300);
      drawWheel();
      setTimeout(() => spinWheel(phone), 500);
    }
  </script>
</body>

</html>